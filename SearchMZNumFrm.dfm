object SearchMZNumForm: TSearchMZNumForm
  Left = 387
  Top = 267
  BorderStyle = bsDialog
  Caption = #35831#36755#20837#24739#32773#38376#35786#21495
  ClientHeight = 407
  ClientWidth = 827
  Color = clBtnFace
  Font.Charset = GB2312_CHARSET
  Font.Color = clWindowText
  Font.Height = -15
  Font.Name = #23435#20307
  Font.Style = []
  KeyPreview = True
  OldCreateOrder = False
  Position = poScreenCenter
  OnCreate = FormCreate
  OnKeyPress = FormKeyPress
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 15
  object TitleLabel: TRzLabel
    Left = 48
    Top = 32
    Width = 128
    Height = 16
    Caption = #35831#36755#20837#24739#32773#38376#35786#21495
    Font.Charset = GB2312_CHARSET
    Font.Color = clWindowText
    Font.Height = -16
    Font.Name = #23435#20307
    Font.Style = []
    ParentFont = False
    BlinkIntervalOff = 1000
    BlinkIntervalOn = 1000
  end
  object OkBtn: TRzBitBtn
    Left = 432
    Top = 368
    Width = 81
    Caption = '&/ '#30830#35748
    Font.Charset = GB2312_CHARSET
    Font.Color = clWindowText
    Font.Height = -13
    Font.Name = #23435#20307
    Font.Style = []
    HotTrack = True
    ParentFont = False
    TabOrder = 1
    OnClick = OkBtnClick
    Glyph.Data = {
      36060000424D3606000000000000360400002800000020000000100000000100
      0800000000000002000000000000000000000001000000000000000000003300
      00006600000099000000CC000000FF0000000033000033330000663300009933
      0000CC330000FF33000000660000336600006666000099660000CC660000FF66
      000000990000339900006699000099990000CC990000FF99000000CC000033CC
      000066CC000099CC0000CCCC0000FFCC000000FF000033FF000066FF000099FF
      0000CCFF0000FFFF000000003300330033006600330099003300CC003300FF00
      330000333300333333006633330099333300CC333300FF333300006633003366
      33006666330099663300CC663300FF6633000099330033993300669933009999
      3300CC993300FF99330000CC330033CC330066CC330099CC3300CCCC3300FFCC
      330000FF330033FF330066FF330099FF3300CCFF3300FFFF3300000066003300
      66006600660099006600CC006600FF0066000033660033336600663366009933
      6600CC336600FF33660000666600336666006666660099666600CC666600FF66
      660000996600339966006699660099996600CC996600FF99660000CC660033CC
      660066CC660099CC6600CCCC6600FFCC660000FF660033FF660066FF660099FF
      6600CCFF6600FFFF660000009900330099006600990099009900CC009900FF00
      990000339900333399006633990099339900CC339900FF339900006699003366
      99006666990099669900CC669900FF6699000099990033999900669999009999
      9900CC999900FF99990000CC990033CC990066CC990099CC9900CCCC9900FFCC
      990000FF990033FF990066FF990099FF9900CCFF9900FFFF99000000CC003300
      CC006600CC009900CC00CC00CC00FF00CC000033CC003333CC006633CC009933
      CC00CC33CC00FF33CC000066CC003366CC006666CC009966CC00CC66CC00FF66
      CC000099CC003399CC006699CC009999CC00CC99CC00FF99CC0000CCCC0033CC
      CC0066CCCC0099CCCC00CCCCCC00FFCCCC0000FFCC0033FFCC0066FFCC0099FF
      CC00CCFFCC00FFFFCC000000FF003300FF006600FF009900FF00CC00FF00FF00
      FF000033FF003333FF006633FF009933FF00CC33FF00FF33FF000066FF003366
      FF006666FF009966FF00CC66FF00FF66FF000099FF003399FF006699FF009999
      FF00CC99FF00FF99FF0000CCFF0033CCFF0066CCFF0099CCFF00CCCCFF00FFCC
      FF0000FFFF0033FFFF0066FFFF0099FFFF00CCFFFF00FFFFFF00000080000080
      000000808000800000008000800080800000C0C0C00080808000191919004C4C
      4C00B2B2B200E5E5E5005A1E1E00783C3C0096646400C8969600FFC8C800465F
      82005591B9006EB9D7008CD2E600B4E6F000D8E9EC0099A8AC00646F7100E2EF
      F100C56A31000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000EEEEEEEEEEEE
      EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE
      EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE180C
      EEEEEEEEEEEEEEEEEEEEEEEEEEEEE2DFEEEEEEEEEEEEEEEEEEEEEEEEEE181212
      0CEEEEEEEEEEEEEEEEEEEEEEEEE28181DFEEEEEEEEEEEEEEEEEEEEEE18121212
      120CEEEEEEEEEEEEEEEEEEEEE281818181DFEEEEEEEEEEEEEEEEEE1812121212
      12120CEEEEEEEEEEEEEEEEE2818181818181DFEEEEEEEEEEEEEEEE1812120C18
      1212120CEEEEEEEEEEEEEEE28181DFE2818181DFEEEEEEEEEEEEEE18120CEEEE
      181212120CEEEEEEEEEEEEE281DFEEEEE2818181DFEEEEEEEEEEEE180CEEEEEE
      EE181212120CEEEEEEEEEEE2DFEEEEEEEEE2818181DFEEEEEEEEEEEEEEEEEEEE
      EEEE181212120CEEEEEEEEEEEEEEEEEEEEEEE2818181DFEEEEEEEEEEEEEEEEEE
      EEEEEE181212120CEEEEEEEEEEEEEEEEEEEEEEE2818181DFEEEEEEEEEEEEEEEE
      EEEEEEEE181212120CEEEEEEEEEEEEEEEEEEEEEEE2818181DFEEEEEEEEEEEEEE
      EEEEEEEEEE1812120CEEEEEEEEEEEEEEEEEEEEEEEEE28181DFEEEEEEEEEEEEEE
      EEEEEEEEEEEE18120CEEEEEEEEEEEEEEEEEEEEEEEEEEE281DFEEEEEEEEEEEEEE
      EEEEEEEEEEEEEE180CEEEEEEEEEEEEEEEEEEEEEEEEEEEEE2DFEEEEEEEEEEEEEE
      EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE}
    NumGlyphs = 2
  end
  object CancelBtn: TRzBitBtn
    Left = 536
    Top = 368
    Width = 81
    Caption = #21462#28040
    Font.Charset = GB2312_CHARSET
    Font.Color = clWindowText
    Font.Height = -13
    Font.Name = #23435#20307
    Font.Style = []
    HotTrack = True
    ParentFont = False
    TabOrder = 2
    OnClick = CancelBtnClick
    Kind = bkCancel
  end
  object RzGroupBox1: TRzGroupBox
    Left = 32
    Top = 56
    Width = 761
    Height = 297
    Caption = #24403#21069#24739#32773#23545#24212#30340#30005#23376#30003#35831
    Font.Charset = GB2312_CHARSET
    Font.Color = clWindowText
    Font.Height = -12
    Font.Name = #23435#20307
    Font.Style = []
    ParentFont = False
    TabOrder = 3
    object RzDBGrid1: TRzDBGrid
      Left = 16
      Top = 24
      Width = 729
      Height = 257
      Ctl3D = True
      DataSource = DataSource1
      DefaultDrawing = False
      Font.Charset = GB2312_CHARSET
      Font.Color = clWindowText
      Font.Height = -15
      Font.Name = #23435#20307
      Font.Style = []
      Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete, dgCancelOnExit]
      ParentCtl3D = False
      ParentFont = False
      PopupMenu = PopupMenu1
      TabOrder = 0
      TitleFont.Charset = GB2312_CHARSET
      TitleFont.Color = clWindowText
      TitleFont.Height = -15
      TitleFont.Name = #23435#20307
      TitleFont.Style = []
      OnDrawColumnCell = RzDBGrid1DrawColumnCell
      OnDblClick = RzDBGrid1DblClick
      OnKeyDown = RzDBGrid1KeyDown
      FrameVisible = True
      QuickCompare.FieldValue = 1
      AltRowShading = False
      Columns = <
        item
          Expanded = False
          Width = 18
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'MZNum'
          Title.Alignment = taCenter
          Title.Caption = #38376#35786#21495
          Width = 78
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'fsksname'
          Title.Alignment = taCenter
          Title.Caption = #25191#34892#31185#23460
          Width = 112
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'ysname'
          Title.Alignment = taCenter
          Title.Caption = #24320#21333#21307#24072
          Width = 62
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'xmmoney'
          Title.Alignment = taCenter
          Title.Caption = #39033#30446#37329#39069
          Width = 69
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'xmflag'
          Title.Alignment = taCenter
          Title.Caption = #31867#21035
          Width = 108
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'CFTypeDisp'
          Title.Alignment = taCenter
          Title.Caption = #31867'  '#22411
          Width = 109
          Visible = True
        end
        item
          Expanded = False
          FieldName = 'xmdate'
          Font.Charset = GB2312_CHARSET
          Font.Color = clWindowText
          Font.Height = -13
          Font.Name = #23435#20307
          Font.Style = []
          Title.Alignment = taCenter
          Title.Caption = #30003#35831#26085#26399
          Width = 134
          Visible = True
        end>
    end
  end
  object SearchEdit: TRzButtonEdit
    Left = 184
    Top = 27
    Width = 161
    Height = 23
    FrameVisible = True
    TabOrder = 0
    OnKeyDown = SearchEditKeyDown
    FlatButtons = True
    OnButtonClick = SearchEditButtonClick
  end
  object YHYB_TSJCCheckBox: TRzCheckBox
    Left = 368
    Top = 32
    Width = 193
    Height = 17
    Caption = #25353#38134#28023#21307#20445#29305#26816#29305#27835#39033#30446#20998#31867
    Font.Charset = GB2312_CHARSET
    Font.Color = clRed
    Font.Height = -13
    Font.Name = #23435#20307
    Font.Style = []
    HotTrack = True
    ParentFont = False
    State = cbUnchecked
    TabOrder = 4
    OnClick = YHYB_TSJCCheckBoxClick
  end
  object DateLimitCheckBox: TRzCheckBox
    Left = 576
    Top = 32
    Width = 193
    Height = 17
    Caption = #20165#26174#31034'48'#23567#26102#20869#30340#26410#32564#36153#35760#24405
    Font.Charset = GB2312_CHARSET
    Font.Color = clWindowText
    Font.Height = -13
    Font.Name = #23435#20307
    Font.Style = []
    HotTrack = True
    ParentFont = False
    State = cbUnchecked
    TabOrder = 5
    OnClick = YHYB_TSJCCheckBoxClick
  end
  object GetMZYZQuery: TQuery
    SQL.Strings = (
      'delete _selmzyz where userid=:userid'
      ''
      'if (:flag) = 0'
      'begin'
      '  insert _selmzyz(mznum,applynum,flag,userid,selected)'
      '      select :mznum,cfnum as applynum,0 as flag,:userid,1'
      '        from mzcfinf_yz (nolock)'
      '        where mznum=:mznum and mzoper is null'
      '      union all'
      '      select :mznum,applynum,1,:userid,1'
      '        from patient_applicationsheet (nolock)'
      '        where jzoper is null and mznum=:mznum'
      '      order by flag,applynum'
      'end else'
      'begin'
      '  if (:TSJC) = 0'
      '  begin'
      
        '    insert _selmzyz(mznum,applynum,flag,userid,selected,YHYB_TSJ' +
        'C,CheckMoney,IsPart)'
      
        '        select mznum,cfnum as applynum,0 as flag,:userid,1,null,' +
        'null,null'
      '          from mzcfinf_yz (nolock)'
      
        '          where patientid=:patientid and mzoper is null and cfda' +
        'te>=:begdate'
      '        union all'
      '        select mznum,applynum,1,:userid,1,null,null,null'
      '          from patient_applicationsheet (nolock)'
      
        '          where jzoper is null and patientid=:patientid and appl' +
        'ydate>=:begdate and mznum is not null'
      '        union all'
      '        select mznum,-mznum,2,:userid,1,null,null,null'
      '          from mzregistersheet (nolock)'
      
        '          where patientid=:patientid and fpnum is null and xmcod' +
        'e is not null and deldate is null and registerdate>=:begdate and' +
        ' xmmoney<>0'
      '        order by mznum desc,flag,applynum'
      '  end else'
      '  begin'
      
        '    insert _selmzyz(mznum,applynum,flag,userid,selected,YHYB_TSJ' +
        'C,CheckMoney,IsPart)'
      
        '        select mznum,cfnum as applynum,0 as flag,:userid,1,null,' +
        'null,null'
      '          from mzcfinf_yz (nolock)'
      
        '          where patientid=:patientid and mzoper is null and cfda' +
        'te>=:begdate and cfdate>=:begdate'
      '        union all'
      
        '        select a.mznum,a.applynum,1,:userid,1,c.yhyb_tsjc,sum(b.' +
        'checkmoney) as checkmoney,case when sum(b.checkmoney)<>a.checkmo' +
        'ney then 1 else null end'
      
        '          from patient_applicationsheet a (nolock),patient_appli' +
        'cationcheckcode b (nolock),checkcode c'
      
        '          where a.applynum=b.applynum and b.checkno=c.code and a' +
        '.patientid=:patientid and b.yjfpnum is null and applydate>=:begd' +
        'ate and a.mznum is not null'
      '          group by a.mznum,a.applynum,a.checkmoney,c.yhyb_tsjc'
      '        union all'
      '        select mznum,-mznum,2,:userid,1,null,null,null'
      '          from mzregistersheet (nolock)'
      
        '          where patientid=:patientid and fpnum is null and xmcod' +
        'e is not null and deldate is null and registerdate>=:begdate and' +
        ' xmmoney<>0'
      '        order by mznum desc,flag,applynum'
      '  end'
      'end'
      ''
      '')
    Left = 40
    Top = 72
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'flag'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'mznum'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'mznum'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'mznum'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'mznum'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'TSJC'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'patientid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'patientid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'patientid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'patientid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'patientid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'patientid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'begdate'
        ParamType = ptUnknown
      end>
  end
  object _SelMZYZQuery: TQuery
    DatabaseName = 'MZDATA'
    SQL.Strings = (
      
        'select keyno,selected,ysksname as fsksname,ysname,cfmoney as xmm' +
        'oney,'
      '  case when jdflag=1 then '#39#33647#36153'('#21547#28082#20307')'#39' else '#39#33647#36153#39' end as xmflag,'
      '  cfdate as xmdate,a.cfnum as applynum,flag,a.mznum,'
      '  case when cftype is null then '#39#26222#36890#22788#26041#39
      '       when cftype=1 then '#39#24613#35786#22788#26041#39
      '       when cftype=2 then '#39#20799#31185#22788#26041#39
      '       when cftype=3 then '#39#31532#20108#31867#31934#31070#39
      '       when cftype=4 then '#39#31532#19968#31867#31934#31070#39
      '       when cftype=5 then '#39#29305#27530#30142#30149'('#38376#35786#22823#30149')'#39
      '       when cftype=6 then '#39#24930#24615#30149#38376#35786#39
      '       when cftype=7 then '#39#27602#40635#22788#26041#39
      '  end cftypedisp,'
      '  null as ispart'
      '  from mzcfinf_yz a (nolock),_selmzyz b (nolock),'
      '  (select cfnum,max(flag) as jdflag from'
      
        '  (select cfnum,case when yppath in(select pathname from yppathc' +
        'ode where groupflag='#39#38745#28404#21345#39' or groupflag='#39#27880#23556#21345#39') then 1 end as flag'
      
        '     from mzcfypk_yz,_selmzyz where cfnum=applynum and userid=:u' +
        'serid) disp1'
      '     group by cfnum) disp2'
      
        ' where a.cfnum=b.applynum and a.cfnum=disp2.cfnum and userid=:us' +
        'erid and flag=0 and a.mznum<>0'
      'union all'
      'select keyno,selected,fsksname,ysname,'
      
        '       case when ispart=1 then _selmzyz.checkmoney else patient_' +
        'applicationsheet.checkmoney end as checkmoney,'
      
        '       '#39#35786#30103#36153#39' as xmflag,applydate as xmdate,_selmzyz.applynum,fla' +
        'g,patient_Applicationsheet.mznum,'
      '       case'
      
        '         when ispart is null and Emergency_Flag=1 and SpecialFla' +
        'g is null then '#39#24613#35786#39
      
        '         when ispart is null and Emergency_Flag=1 and SpecialFla' +
        'g=1 then '#39#24613#35786' + '#29305#27530#30149#39
      
        '         when ispart is null and Emergency_Flag is null and Spec' +
        'ialFlag=1 then '#39#29305#27530#30149#39
      '         when ispart=1 then '#39#29305#26816#25286#20998#39
      '         else null'
      '       end as cftypedisp,'
      '       ispart'
      '  from patient_applicationsheet (nolock),_selmzyz (nolock)'
      
        '  where patient_applicationsheet.applynum=_selmzyz.applynum and ' +
        'userid=:userid and flag=1 and patient_Applicationsheet.mznum<>0'
      'union all'
      
        'select keyno,selected,ksname,ysname,xmmoney,'#39#25346#21495#36153#39' as xmflag,regi' +
        'sterdate as xmdate,_selmzyz.applynum,flag,mzregistersheet.mznum,' +
        'null as cftypedisp,null as ispart'
      '  from mzregistersheet (nolock),_selmzyz (nolock)'
      
        '  where mzregistersheet.mznum=_selmzyz.mznum and userid=:userid ' +
        'and flag=2 and mzregistersheet.mznum<>0'
      'order by a.mznum desc ,xmdate asc')
    Left = 40
    Top = 104
    ParamData = <
      item
        DataType = ftFloat
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftFloat
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftFloat
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftFloat
        Name = 'userid'
        ParamType = ptUnknown
      end>
  end
  object DataSource1: TDataSource
    DataSet = _SelMZYZQuery
    Left = 40
    Top = 136
  end
  object InitQuery: TQuery
    SQL.Strings = (
      'delete _selmzyz where userid=:userid')
    Left = 40
    Top = 176
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end>
  end
  object SetQuery: TQuery
    SQL.Strings = (
      'update _selmzyz'
      '  set selected=:selected'
      '  where keyno=:keyno')
    Left = 40
    Top = 216
    ParamData = <
      item
        DataType = ftInteger
        Name = 'selected'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'keyno'
        ParamType = ptUnknown
      end>
  end
  object ImageList1: TImageList
    Left = 72
    Top = 72
    Bitmap = {
      494C010102000500040010001000FFFFFFFFFF10FFFFFFFFFFFFFFFF424D3600
      0000000000003600000028000000400000002000000001002000000000000020
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000CC00000066000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000B2B2B2008080800000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000000000000000000000000000000000000000CC
      0000009900000099000000660000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000B2B2
      B200999999009999990080808000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000CC00000099
      0000009900000099000000990000006600000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000B2B2B2009999
      9900999999009999990099999900808080000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000CC0000009900000099
      0000009900000099000000990000009900000066000000000000000000000000
      00000000000000000000000000000000000000000000B2B2B200999999009999
      9900999999009999990099999900999999008080800000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000CC0000009900000099
      00000066000000CC000000990000009900000099000000660000000000000000
      00000000000000000000000000000000000000000000B2B2B200999999009999
      990080808000B2B2B20099999900999999009999990080808000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000CC0000009900000066
      0000000000000000000000CC0000009900000099000000990000006600000000
      00000000000000000000000000000000000000000000B2B2B200999999008080
      80000000000000000000B2B2B200999999009999990099999900808080000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000CC0000006600000000
      000000000000000000000000000000CC00000099000000990000009900000066
      00000000000000000000000000000000000000000000B2B2B200808080000000
      0000000000000000000000000000B2B2B2009999990099999900999999008080
      8000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000000000000000CC000000990000009900000099
      0000006600000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000B2B2B20099999900999999009999
      9900808080000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000CC0000009900000099
      0000009900000066000000000000000000000000000000000000000000000000
      00000000000000000000000000000000000000000000B2B2B200999999009999
      9900999999008080800000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000CC00000099
      0000009900000066000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000B2B2B2009999
      9900999999008080800000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000000000000000000000000000000000000000CC
      0000009900000066000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000B2B2
      B200999999008080800000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000CC00000066000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000B2B2B2008080800000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000424D3E000000000000003E000000
      2800000040000000200000000100010000000000000100000000000000000000
      000000000000000000000000FFFFFF0000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000000000FFFFFFFF00000000FFFFFFFF00000000
      F3FFF3FF00000000E1FFE1FF00000000C0FFC0FF00000000807F807F00000000
      803F803F000000008C1F8C1F000000009E0F9E0F00000000FF07FF0700000000
      FF83FF8300000000FFC3FFC300000000FFE3FFE300000000FFF3FFF300000000
      FFFFFFFF00000000FFFFFFFF0000000000000000000000000000000000000000
      000000000000}
  end
  object SetAllQuery: TQuery
    SQL.Strings = (
      'update _selmzyz'
      '  set selected=:selected'
      '  where userid=:userid')
    Left = 40
    Top = 256
    ParamData = <
      item
        DataType = ftInteger
        Name = 'selected'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end>
  end
  object PopupMenu1: TPopupMenu
    AutoHotkeys = maManual
    Left = 80
    Top = 136
    object N1: TMenuItem
      Caption = #36873#20013#25152#26377#30003#35831
      OnClick = N1Click
    end
    object N2: TMenuItem
      Caption = '-'
    end
    object N3: TMenuItem
      Caption = #21462#28040#25152#26377#30003#35831
      OnClick = N3Click
    end
  end
  object CheckQuery: TQuery
    SQL.Strings = (
      
        'if not exists(select keyno from _selmzyz (nolock) where userid=:' +
        'userid and selected=1)'
      'begin'
      '  select -1 as ret'
      '  return'
      'end'
      'declare @t_count int'
      'select @t_count=count(*) from'
      '  (select mznum from _selmzyz (nolock)'
      '     where userid=:userid and selected=1'
      '      group by mznum) disp'
      'if @t_count>1'
      'begin'
      '  select -2 as ret'
      '  return'
      'end'
      ''
      'select @t_count=0'
      'select @t_count=count(*) from'
      '(select keyno'
      '  from mzcfinf_yz (nolock),_selmzyz (nolock)'
      
        ' where cfnum=applynum and userid=:userid  and flag=0 and selecte' +
        'd=1'
      'union all'
      'select keyno'
      '  from patient_applicationsheet (nolock),_selmzyz (nolock)'
      
        '  where patient_applicationsheet.applynum=_selmzyz.applynum and ' +
        'userid=:userid and flag=1 and selected=1) disp'
      ''
      'declare @t_ghcount int'
      'select @t_ghcount= 0'
      'select @t_ghcount=count(*)'
      '  from mzregistersheet (nolock),_selmzyz (nolock)'
      
        '  where mzregistersheet.mznum=_selmzyz.mznum and userid=:userid ' +
        'and flag=2 and selected=1'
      'if @t_count>0 and @t_ghcount>0'
      'begin'
      '  select -3 as ret'
      '  return'
      'end'
      ''
      'if @t_ghcount>1'
      'begin'
      '  select -4 as ret'
      '  return'
      'end'
      ''
      ''
      
        'select @t_count=count(*) from _selmzyz (nolock) where userid=:us' +
        'erid and selected=1'
      
        'if @t_count>1 and exists(select keyno from _selmzyz (nolock) whe' +
        're userid=:userid and ispart=1)'
      'begin'
      '  select -5 as ret'
      '  return'
      'end'
      ''
      'select mznum as ret from'
      '  (select mznum from _selmzyz (nolock)'
      '     where userid=:userid and selected=1'
      '      group by mznum) disp'
      '')
    Left = 40
    Top = 288
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end>
  end
  object SetFlag_SLQuery: TQuery
    SQL.Strings = (
      'update _selmzyz'
      '  set selected=null'
      '  where userid=:userid'
      ''
      'update _selmzyz'
      '  set selected=1'
      
        '  where userid=:userid and applynum=:applynum and flag=:flag and' +
        ' ispart is null')
    Left = 88
    Top = 176
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'userid'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'applynum'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'flag'
        ParamType = ptUnknown
      end>
  end
end
